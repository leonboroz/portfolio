Описание проекта

Этот проект представляет собой SQL-запрос и анализ данных, направленный на изучение изменений балансов студентов на образовательной платформе. Исследование выявляет возможные аномалии в платежах и проводит визуальный анализ накопительных данных.

SQL-запрос

Запрос строится поэтапно, начиная с определения первой успешной оплаты каждого пользователя и формирования последовательности дат занятий. Основные шаги:

Определение первой успешной оплаты (first_payments).

Создание последовательности всех дат занятий за 2016 год (all_dates).

Расчет изменений баланса платежей по датам (payments_by_dates).

Определение всех дат, относящихся к пользователю (all_dates_by_user).

Подсчет количества проведенных занятий по датам (classes_by_dates).

Вычисление накопительного изменения баланса (payments_by_dates_cumsums).

Вычисление накопительного изменения количества проведенных занятий (classes_by_dates_dates_cumsum).

Формирование итогового баланса (balances).

Агрегирование данных и сортировка (limit 1000).

Анализ и выводы

Анализ данных выявил ряд проблем:

У некоторых пользователей (user_id 751,900,094 и user_id 59,995,492) обнаружены отрицательные балансы, что противоречит бизнес-логике платформы.

Возможные причины: ошибки в таблице payments, пропущенные или некорректные платежи.

Необходимо проверить таблицу payments и внедрить механизм предупреждения подобных аномалий.

Визуальный анализ

График баланса показал, что количество купленных уроков превышает количество проведенных.

Около 18% купленных уроков остаются неиспользованными, что может указывать на нехватку преподавателей или проблемы в организации учебного процесса.

Возможное последствие: отток пользователей, снижение прибыли.

Рекомендации

Проверка данных в payments, устранение возможных сбоев.

Оптимизация процесса проведения уроков (поиск причин несоответствия, увеличение количества доступных преподавателей).

Внедрение механизма контроля аномальных балансов.

### Как использовать

 Для запуска скрипта:  
     1. Открыть SQL-клиент (DBeaver, DataGrip, pgAdmin и т. д.).  
     2. Подключиться к базе данных `skyeng_db`.  
     3. Открыть файл `balance_analysis.sql`.  
     4. Выполнить код.

Этот README помогает лучше понять SQL-запрос и выявленные проблемы, а также предлагает пути их решения.

